<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>Native Windows GUI guide</title>

    <link rel="stylesheet" type="text/css" href="style/rustbook.css">
    <link rel="stylesheet" type="text/css" href="style/pygments.css">
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->


    <div id="nav">
        <button id="toggle-nav">
            <span class="sr-only">Toggle navigation</span>
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </button>
    </div>

<div id='toc' class='mobile-hidden'>
<ul class='chapter'>
<li><a href='book_10.html'><b>1.</b> Introduction</a>
</li>
<li><a href='book_20.html'><b>2.</b> Getting Started</a>
</li>
<li><a href="book_30.html"><b>3.</b> Basics </a>
<ul class="section">
<li><a href="book_31.html"><b>3.1.</b> Ui objects </a>
</li>
<li><a href="book_32.html"><b>3.2.</b> Control templates </a>
</li>
<li><a href="book_33.html"><b>3.3.</b> Actions </a>
</li>
<li><a href="book_34.html"><b>3.4.</b> Events (TODO) </a>
</li>
</ul>
</li>
<li><a href="book_40.html"><b>4.</b> Built-in Controls (TODO) </a>
</li>
<li><a href="book_50.html"><b>5.</b> User controls (TODO) </a>
</li>
</ul>
</div>

<div id='page-wrapper'>
<div id='page'>
    <h1 class="title">Getting started</h1>
    <p>In this first chapter, you will install NWG and then look at a very simple application. This tutorial
        will intoduce the concepts of <b>Control Templates</b>, <b>Actions</b> and <b>Events</b>: the
        foundations of NWG. The next chapter "Basics" will go deeper into these.
    </p>
    <h1 id="installing-nwg" class="section-header"><a href="#installing-nwg">Installing NWG</a></h1>
    NWG should work with any recent version of rust (64 bits or 32 bits). Any channel can be used (stable, beta, nightly).
    NWG was only tested using the <b>MSVC ABI builds.</b><br/>
    To use NWG in your project add it to <code>cargo.toml</code>:

<pre class="rust rust-example-rendered">[<span class="kw">dependencies</span>]
<span class="ident">native-windows-gui</span> = <span class="string"><span class="string">"</span>0.1.0<span class="string">"</span></span>
</pre>

    And then, in <code>main.rs</code> or <code>lib.rs</code> :

<pre class="rust rust-example-rendered">
<span class="kw">extern crate</span> <span class="ident">native_windows_gui</span> <span class="kw">as</span> <span class="ident">nwg</span>;
</pre>


<h1 id="hello-world" class="section-header"><a href="#hello-world">Hello World!</a></h1>
    Here is a minimalistic program that display a window with a text input and a button. When the button
    is clicked, a messagebox that says "Hello {your name}!" is created.

<div class="syntax"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="k">crate</span><span class="w"> </span><span class="n">native_windows_gui</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">nwg</span><span class="p">;</span><span class="w"></span>

<span class="kn">use</span><span class="w"> </span><span class="n">nwg</span><span class="o">::</span><span class="n">Ui</span><span class="p">;</span><span class="w"></span>
<span class="kn">use</span><span class="w"> </span><span class="n">nwg</span><span class="o">::</span><span class="n">events</span><span class="o">::</span><span class="n">EventCallback</span><span class="p">;</span><span class="w"></span>
<span class="kn">use</span><span class="w"> </span><span class="n">nwg</span><span class="o">::</span><span class="n">controls</span><span class="o">::</span><span class="p">{</span><span class="n">Button</span><span class="p">,</span><span class="w"> </span><span class="n">Window</span><span class="p">,</span><span class="w"> </span><span class="n">TextInput</span><span class="p">};</span><span class="w"></span>
<span class="kn">use</span><span class="w"> </span><span class="n">nwg</span><span class="o">::</span><span class="n">actions</span><span class="o">::</span><span class="p">{</span><span class="n">Action</span><span class="p">,</span><span class="w"> </span><span class="n">ActionReturn</span><span class="p">};</span><span class="w"></span>
<span class="kn">use</span><span class="w"> </span><span class="n">nwg</span><span class="o">::</span><span class="n">actions</span><span class="o">::</span><span class="n">helper</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">actions_help</span><span class="p">;</span><span class="w"></span>
<span class="kn">use</span><span class="w"> </span><span class="n">nwg</span><span class="o">::</span><span class="n">constants</span><span class="o">::</span><span class="p">{</span><span class="n">HTextAlign</span><span class="p">,</span><span class="w"> </span><span class="n">VTextAlign</span><span class="p">,</span><span class="w"> </span><span class="n">MessageButtons</span><span class="p">,</span><span class="w"> </span><span class="n">MessageIcons</span><span class="p">};</span><span class="w"></span>

<span class="k">fn</span><span class="w"> </span><span class="n">setup_controls</span><span class="p">(</span><span class="n">ui</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">Ui</span><span class="o">&lt;&amp;</span><span class="nb">'static</span><span class="w"> </span><span class="kt">str</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">main_window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Window</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">caption</span><span class="o">:</span><span class="w"> </span><span class="s">"Hello"</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="n">size</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">position</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">visible</span><span class="o">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">resizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">exit_on_close</span><span class="o">:</span><span class="w"> </span><span class="k">true</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">name_input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextInput</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">text</span><span class="o">:</span><span class="w"> </span><span class="s">""</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="n">size</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">position</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">parent</span><span class="o">:</span><span class="w"> </span><span class="s">"MainWindow"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">placeholder</span><span class="o">:</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="s">"Your name Here"</span><span class="p">.</span><span class="n">to_string</span><span class="p">()),</span><span class="w"></span>
<span class="w">        </span><span class="n">text_align</span><span class="o">:</span><span class="w"> </span><span class="n">HTextAlign</span><span class="o">::</span><span class="n">Left</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">password</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">readonly</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">hello_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Button</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">text</span><span class="o">:</span><span class="w"> </span><span class="s">"Say Hello!"</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="n">size</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">130</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">position</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">parent</span><span class="o">:</span><span class="w"> </span><span class="s">"MainWindow"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">text_align</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">HTextAlign</span><span class="o">::</span><span class="n">Center</span><span class="p">,</span><span class="w"> </span><span class="n">VTextAlign</span><span class="o">::</span><span class="n">Center</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">new_control</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span><span class="w"> </span><span class="n">main_window</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">new_control</span><span class="p">(</span><span class="s">"Name"</span><span class="p">,</span><span class="w"> </span><span class="n">name_input</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">new_control</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">,</span><span class="w"> </span><span class="n">hello_button</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">ui</span><span class="o">:</span><span class="w"> </span><span class="n">Ui</span><span class="o">&lt;&amp;</span><span class="nb">'static</span><span class="w"> </span><span class="kt">str</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ui</span><span class="o">::</span><span class="n">new</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">setup_controls</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">ui</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">,</span><span class="w"> </span><span class="s">"SayHello"</span><span class="p">,</span><span class="w"> </span><span class="n">EventCallback</span><span class="o">::</span><span class="n">Click</span><span class="p">(</span><span class="nb">Box</span><span class="o">::</span><span class="n">new</span><span class="p">(</span><span class="o">|</span><span class="n">ui</span><span class="p">,</span><span class="w"> </span><span class="n">caller</span><span class="o">|</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">"Caller is: {:?}"</span><span class="p">,</span><span class="w"> </span><span class="n">caller</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Ok</span><span class="p">(</span><span class="n">ActionReturn</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">name</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui</span><span class="p">.</span><span class="n">exec</span><span class="p">(</span><span class="s">"Name"</span><span class="p">,</span><span class="w"> </span><span class="n">Action</span><span class="o">::</span><span class="n">GetText</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_help</span><span class="o">::</span><span class="n">message</span><span class="p">(</span><span class="w"></span>
<span class="w">                </span><span class="s">"Hello!"</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">"Hello {}!"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">),</span><span class="w"></span>
<span class="w">                </span><span class="n">MessageButtons</span><span class="o">::</span><span class="nb">Ok</span><span class="p">,</span><span class="w"> </span><span class="n">MessageIcons</span><span class="o">::</span><span class="nb">None</span><span class="w"></span>
<span class="w">            </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">ui</span><span class="p">.</span><span class="n">exec</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span>
<span class="w">    </span><span class="p">}))).</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">nwg</span><span class="o">::</span><span class="n">dispatch_events</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>

<h1 id="hello-details" class="section-header"><a href="#hello-details">The example details</a></h1>

<h3>UI creation</h3>
The first line executed in the <code>main</code> function creates the <b>Ui</b> object. You can think of it as some
kind of service. In fact, NWG Ui abstract the whole UI, this means that, as a developer, <b>you don't have access to the
actual controls</b>.</br></br>

In order to expose the controls to the developer, NWG uses <b>controls IDS</b>. This way, controls can be accessed from
anywhere in the code without you having drag some kind of data along. <b>The type of the ID is choosen by the developer</b>, but 
the it must implement the <code>Eq+Clone+Hash</code> traits.</br></br>

For this example the control id type is <code>&'static str</code>. Using <code>str</code> is great for visibility,
but it has one big inconvenient: <b>you can't create controls on the fly</b>. </br></br>    

Yup, with NWG <b>all created controls must have a unique name</b>. Because of this, using <code>int</code> with 
<code>const</code> is usually a better idea. You could also use enums.<br/><br/>

<u>Note 1</u>: <b>Ui objects are single threaded</b> <code>(!Send + !Sync)</code>. This is a OS restriction, so it will never go away.
<br/><br/>

<u>Note 2</u>: Currently, <b>there can only be one Ui object per thread</b>. This restriction might be lifted in
the future in the BETA/STABLE release.

<h3>Creating controls</h3>

Now that the Ui object is created, it's time to create the controls! Creating controls is done with 
<b>Control Templates</b>. Control templates are transparent structures that implements the <code>ControlTemplate</code>
trait. NWG offers a wide variety of built-in controls. For more details see:
<a href="book_40.html">The Controls dictionnary</a>. <br/><br/>

<b>Once a template is filled, it can be added to the GUI by calling</b> <code>ui.new_control</code>. The first argument
is the unique control ID and the second is the template. The creation can fail if the ID already exists or if the
template configurations contains invalid values. <br/><br/>

With the exception of the Window control, <b>all controls must have a parent</b>. A parent must have been created
before its children. If a children control is created before its parent, a <b>CONTROL_NOT_FOUND</b> error
will be returned.<br/><br/>

<u>Note 1</u>: As you can see, control templates are very verbose. Because of this it is a good idea to put the controls creation
in its own function. This is a design choice. Most GUI are now done though some kind of markup language or
WYSIWYG editors (which I plan to work on once BETA is reached). Templates were designed to make the creation process
of those tools easier.
<br/><br/>

<u>Note 3</u>: <b>Templates fields are unstable</b>. I will most likely add new fields before the BETA release. 

<h3>Binding events</h3>

Now that the controls are created, it's time to make the GUI respond to the user. This is done though
<b>callbacks</b> and <b>events</b>.<br/><br/>

You can bind an event to a widget using the <code>bind</code> method of Ui. The first argument is <b>the widget
identifer</b>, the second is <b>a user indentifier for the callback</b> and the third is the <b>EventCallback</b>.
<br/><br/>

Every event that can be bound to a control is defined under the <code>EventCallback</code> enum. The enum either
take a boxed <code>fn</code> or a boxed <code>closure</code>. <b>The first two parameters are always the Ui and the
caller ID</b>. Depending on the callback, more values can be passed.<br/><br/>

Note 1: Two events callback of the same type on the same control cannot have the same identifier. Duplicate are possible in
any other combinations (ex: two different events on the same control can have a callback named "foo").<br/><br/>

Note 2: <b>Not all control support all events</b>; if an event is bound to a control that do not support it, an error
is returned.<br/><br/>

Note 3: The events API is mostly stable. The only thing that is subject to change is the EventCallback definition.
(I want to remove the box).

<h3>Executing actions</h3>

The last thing left to explain is how to interact with the controls from the code. This is done by sending 
<b>Actions</b> to the ui using the <code>exec</code> method and then reading the returned <b>ActionReturn</b>. 
The first parameter is <b>the identifier of the control that will receive the event</b>, the second is <b>the action.</b><br/><br/>

An action sent  <b>can return different kind of ActionReturn</b>. An action that don't return stuff (ex: SetText) will 
always return <code>ActionReturn::None</code>, furthermore, sending an unsupported action to a control
(ex: GetReadOnly of a label) <b>is not considered an error</b>. Instead <code>ActionReturn::NotSupported</code>
will be returned.<br/><br/>

Just like the events, all Actions/ActionReturn are located under an enum: the <code>Action/ActionReturn</code>
enums. <br/><br/>

Note 1: The existing actions are stable and will most likely not change. Obviously, more will be added.<br/><br/>

Note 2: An Action/ActionReturn size is limited to 16 bytes. If the data contained is bigger than this, it must be
boxed. Boxed actions have helpers to not reduce the code readability.<br/><br/>

<h3>Listening for events</h3>
Once your setup is completed, you must call <code>nwg::dispatch_events</code> in order to block the thread and 
process the system events. The function will return once a <b>Quit</b> event is received.<br/><br/>

If you are famliar with the Winapi, this method simply wraps a simple <code>GetMessageW</code> loop.
<br/><br/>
</div>
</div>

<br/><br/><script src='style/rustbook.js'></script>
</body>
</html>
